# minimdb
Mini IMDB. The movies and TV shows catalogue.

 Quick and dirty demo project featuring the following topics:

* ASP.Net Core backend
  * API built with DI
  * Different configurations for different environments
  * Connected to PostgreSQL database with EF core
  * CRUD operations, pagination, search
  * Authentication and authorization using JWT tokens
  * Data validation
  * In-memory caching example
  * Basic internationalization example with 3 languages
  * Exception handling strategy: it's better to avoid using exceptions or convert them into app specific error objects
  * API documentation using Swagger
* Angular 8 frontend
  * Backend API usage
  * Authentication and Authorization quick and dirty idea
  * Input data validation
  * CRUD operations, pagination, search
  * Basic internationalization example with 3 languages
  * Different configurations for testing purposes
* Docker containerization

## How to build and run

### Running in Docker
```
docker-compose build
docker-compose up -d
```
To stop:
`docker-compose down`

The application will be available at http://localhost:10080

To build project image run in solution directory:

`docker build -f "MiniMdb.Backend\Dockerfile" -t minimdb.backend .`

### Running locally:

Prerequisites:
* NPM 6+ https://nodejs.org/en/download/
* .NET Core 3.1 https://dotnet.microsoft.com/download/dotnet-core/3.1
* (Visual Studio 2019 or VS Code)

The app requires Postgres database at runtime.
The easiest way to have it is run it in docker like this:
`docker run --name minimdb_postgres_dev -v minimdbdata:/var/lib/postgresql/data -p 5432:5432 postgres:11 -e POSTGRES_PASSWORD=postgres -e POSTGRES_DB=minimdb-dev`

To start the app locally run the following commands inside MiniMdb.Backend directory:
```
set ASPNETCORE_ENVIRONMENT Development
dotnet restore
dotnet build
dotnet run
```

To run frontend separately use the following commands inside MiniMdb.Backend/ClientApp directory:

```
npm install
npm run ng serve
```

The app will be available by the url: http://localhost:5000

Autogenerated API docs: `http://localhost:5000/swagger`

If there are problems with SSL certificate: https://docs.microsoft.com/en-us/aspnet/core/security/docker-https?view=aspnetcore-3.1
(even though I turned off HTTPS for simplicity)

## Testing
To run tests run the following command in solution directory:
```
dotnet test MiniMdb.Testing
```

## Authentication and authorization

There are two hardcoded users:
1. Admin role, `admin@example.com`, `m3g@pA$$W0rDDD`
2. User role, `anyone@example.com`, `w3@kpa$$w0rd`

Admin can do any operation in the app including: creating new titles, editing, removing.
User can't edit or create anything. The only difference from anonymous access is the ability to
see Movie/Series details on a separate page (just a demonstration of authorization policies).